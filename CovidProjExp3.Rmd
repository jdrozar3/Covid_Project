---
title: "Covid Project Group 3 Exploration 3: Counts and Rates by Continent"
author: "Kaitlyn Won (Data Processing for Rates/Visualization), Jyoti Michael D Rozario (Data Processing for Counts), BaoLong Nguyen (Data Analysis)"
output:
  html_document:
    number_sections: yes
    toc: yes  
  pdf_document:
    toc: yes
---
```{r setup, warning=FALSE}
```

# Data Processing/Visualization: Total Confirmed Cases by Continent
Read in all the csv files per continent.
```{r}
africa = read.csv("refined_data_Africa.csv")
asia = read.csv("refined_data_Asia.csv")
australia = read.csv("refined_data_Australia.csv")
europe = read.csv("refined_data_Europe.csv")
north_america = read.csv("refined_data_North_America.csv")
south_america = read.csv("refined_data_South_America.csv")
```

Total number of confirmed cases per continent calculated 
```{r}
africa_total_cases = sum(africa$Total.Confirmed.Cases)
asia_total_cases = sum(asia$Total.Confirmed.Cases)
australia_total_cases = sum(australia$Total.Confirmed.Cases)
europe_total_cases = sum(europe$Total.Confirmed.Cases)
na_total_cases = sum(north_america$Total.Confirmed.Cases)
sa_total_cases = sum(south_america$Total.Confirmed.Cases)
total_cases_sum = africa_total_cases + asia_total_cases + australia_total_cases + europe_total_cases + na_total_cases + sa_total_cases
```

Plotted the relative frequencies of the total counts of the confirmed cases
```{r}
total_cases = c(africa_total_cases/total_cases_sum, asia_total_cases/total_cases_sum, australia_total_cases/total_cases_sum, europe_total_cases/total_cases_sum, na_total_cases/total_cases_sum, sa_total_cases/total_cases_sum)
continents = c("Africa", "Asia", "Australia", "Europe", "NA", "SA")
barplot(total_cases, main="Relative Frequency of Total Confirmed Cases by Continent",names.arg=continents, ylim=c(0,0.3))
```
The first set of data depicts the distribution of Covid cases across different continents. This was done by calculating the total cases in one continent and dividing it by the total count of Covid cases globally. From this, we can observe that Asia has the highest amount of cases, making up 28.86 percent of the globe's total cases. We can also observe that Europe, North America, and South America, all have similar amounts of cases, making up 21.96 percent, 23.36 percent, and 21.96 percent of total global cases, respectively. Africa and Australia contribute significantly less to global Covid cases with Africa making up 3.78 percent and Australia making up 0.06 percent. From this data, we can conclude that Asia, Europe, North America, and South America have been the major  contributors to the total cases during the coronavirus pandemic, most likely because the virus originated in China and these continents generally have more contact with Asia. 

# Data Analysis: Total Confirmed Cases by Continent

# Data Processing/Visualization: Covid Rate by Continent

Installed/added necessary packages and csv file. Notably, the countrycode package is necessary to map countries to continents since this information isn't included in the time series csv. 
```{r}
library(ggplot2)
library(dplyr)
library(remotes) # do install.packages("remotes") if error
# below comment is for countrycode package installation 
# install_github('vincentarelbundock/countrycode') 
library(countrycode)

ts = read.csv("time_series_covid19_confirmed_global.csv")
```

Grouped data by continent (note that the countrycode package groups North and South America as the Americas) and sum each day's covid confirmation case counts per country. Plotted these counts. 
```{r}
ts$Continent = countrycode(ts$Country.Region, "country.name", "continent")

# Had to manually add continents for the few that did not map. Diamond Princess is not a country; it is a 
# cruise ship that was docked in Yokohama, Japan when the coronavirus outbreak happened within the vessel.
# Similarly, MS Zaandam is a cruise ship that was near Panama City when the outbreak happened. 
# Kosovo is a country in Europe.
ts$Continent[which(ts$Country.Region == "Diamond Princess")] = "Asia"
ts$Continent[which(ts$Country.Region == "MS Zaandam")] = "Americas"
ts$Continent[which(ts$Country.Region == "Kosovo")] = "Europe"

ts = select(ts, -c(Province.State, Country.Region, Lat, Long))

ts_by_conts = ts %>% group_by(Continent) %>% summarise_each(funs(sum))
```
Time series all split by continent in separate variables
```{r}
africa_ts = ts_by_conts[ts_by_conts$Continent == "Africa",]
americas_ts = ts_by_conts[ts_by_conts$Continent == "Americas",]
asia_ts = ts_by_conts[ts_by_conts$Continent == "Asia",]
europe_ts = ts_by_conts[ts_by_conts$Continent == "Europe",]
oceania_ts = ts_by_conts[ts_by_conts$Continent == "Oceania",]
```

Function to plot time series by continent 
```{r}
library(rlist)

create_ts_plot <- function(ts) {
  dates = seq(as.Date("2020/1/22"), by="day", length.out = ncol(ts) - 1)
  counts = rep(0, ncol(ts) - 1)
  c = 0
  for (i in colnames(ts)) {
    counts[c] = as.integer(ts[[paste(i)]])
    c = c + 1
  }
  df = data.frame(date = dates, count = counts)
  ggplot(data = df, aes(date, count)) + geom_line()
}
```

Use create_ts_plot function plot time series for each continent's confirmed covid cases
```{r}
create_ts_plot(africa_ts)
create_ts_plot(americas_ts)
create_ts_plot(asia_ts)
create_ts_plot(europe_ts)
create_ts_plot(oceania_ts)
```

Next, we plotted the Covid cases of each continent with respect to time to visualize how Covid cases have grown during the pandemic. As mentioned before, the Americas, Asia, and Europe have much more cases than Australia and Africa. However, each continent is unique in its pattern of growth of Covid cases. 

Africa’s growth was slow during the beginning of the pandemic in early April to May, but cases began exponentially increasing from May to August.  Since then, Africa’s Covid cases have been rising relatively linearly. 
	
The America’s growth of Covid cases has been relatively linear throughout the pandemic. Cases began growing in late March and have continued to grow without resistance.
	
Asia’s cases also began slowly in late March. From April to October, Asia has seen an exponential growth in cases. However starting in October, Asia’s cases began growing linearly. 
	
Covid cases in Europe began growing much earlier than the other continents, starting in mid-March. From then to July, cases in Europe have been growing linearly in a slower rate than Asia and the Americas. However, from July to present, Europe’s cases have continued to grow exponentially. 
	
Australia’s cases also began early with a its own large spike starting in mid-March and lasting until mid-April. Then from mid-April to July, cases have seen little growth, remaining fairly constant. Australia then experienced a second larger spike from July to September, but since then, Covid cases have slowed.
	
From this part of the data, we can observe how Covid cases have grown overtime. It’s noteworthy that cases in each continent all began growing in mid to late March. Asia, Africa, and the Americas have experienced fairly linear growth, while Europe is experiencing exponential growth and Australia has experienced two major spikes in cases. We can observe that with Australia being the exception, each continent has seen little resistance in Covid growth, with cases either growing linearly or exponentially. 

# Data Analysis: Covid Rate by Continent



